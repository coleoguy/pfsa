setwd("C:/Users/Terrence Sylvester/Dropbox/phasmatodea/analysis/data/chrom.data")
chroms <- read.csv("chroms.csv", as.is = T)
chrom.count <- data.frame(table(chroms$hap[chroms$order == "Blattodea"]))
View(chrom.count)
chrom.count <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]))
View(chrom.count)
orders <- unique(chroms$order)
chrom.count <- vector(mode = "list", length = 5)
chrom.count <- vector(mode = "list", length = 11)
names(chrom.count) <- c("BlatAll", orders)
chrom.count <- vector(mode = "list", length = 11)
names(chrom.count)
names(chrom.count) <- c("BlatAll", orders)
for(i in 1:11){
if(i == 1){
chrom.count[[1]] <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]))
}else{
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]))
}
}
chrom.count$BlatAll
max(chrom.count$BlatAll)
max(chrom.count$BlatAll[,2])
max(chrom.count[[1]][,2])
for(i in 1:11){
print(max(chrom.count[[i]][,2]))
}
max(chrom.count[[2]][,2])
for(i in 1:11){
if(i == 1){
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]))
}else{
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order == orders[i]]))
}
}
chrom.count <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]))
for(i in 1:11){
print(max(chrom.count[[i]][,2]))
}
for(i in 1:11){
if(i == 1){
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]))
}else{
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order == orders[i]]))
}
}
chrom.count <- vector(mode = "list", length = 11)
names(chrom.count) <- c("BlatAll", orders)
for(i in 1:11){
if(i == 1){
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]))
}else{
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order == orders[i]]))
}
}
for(i in 1:11){
print(max(chrom.count[[i]][,2]))
}
for(i in 1:11){
if(i == 1){
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]))
}else{
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order == orders[i]]))
}
}
# chrom.count <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]))
for(i in 1:11){
print(max(chrom.count[[i]][,2]))
}
data.frame(table(chroms$hap[chroms$order == orders[i]]))
chroms$hap[chroms$order == orders[i]])
chroms$hap[chroms$order == orders[i]]
chroms$hap
chroms$hap[chroms$order == orders[i]]
chroms$hap[chroms$order == "Plecoptera"]
for(i in 1:11){
if(i == 1){
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]))
}else{
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order == orders[i-1]]))
}
}
# chrom.count <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]))
for(i in 1:11){
print(max(chrom.count[[i]][,2]))
}
which(chrom.count[[i]] == max(chrom.count[[i]][,2]))
for(i in 1:11){
print(which(chrom.count[[i]] == max(chrom.count[[i]][,2])))
print(max(chrom.count[[i]][,2]))
}
chrom.count[[1]]
chrom.count[[i]][,1][chrom.count[[i]][,2] == max(chrom.count[[i]][,2])]
chroms <- read.csv("chroms.csv", as.is = T)
orders <- unique(chroms$order)
chrom.count <- vector(mode = "list", length = 11)
names(chrom.count) <- c("BlatAll", orders)
for(i in 1:11){
if(i == 1){
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]), stringsAsFactors = F)
}else{
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order == orders[i-1]])stringsAsFactors = F)
}
}
chroms <- read.csv("chroms.csv", as.is = T)
orders <- unique(chroms$order)
chrom.count <- vector(mode = "list", length = 11)
names(chrom.count) <- c("BlatAll", orders)
for(i in 1:11){
if(i == 1){
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]), stringsAsFactors = F)
}else{
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order == orders[i-1]])stringsAsFactors = F)
}
}
for(i in 1:11){
if(i == 1){
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]),
stringsAsFactors = F)
}else{
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order == orders[i-1]]),
stringsAsFactors = F)
}
}
chrom.count[[i]][,1][chrom.count[[i]][,2] == max(chrom.count[[i]][,2])]
for(i in 1:11){
print(paste("The mode of ",
names(chrom.count)[i],
" is ",
chrom.count[[i]][,1][chrom.count[[i]][,2] == max(chrom.count[[i]][,2])],
" repating for ",
max(chrom.count[[i]][,2]),
" times."))
}
for(i in 1:11){
print(paste("The mode of",
names(chrom.count)[i],
"is",
chrom.count[[i]][,1][chrom.count[[i]][,2] == max(chrom.count[[i]][,2])],
"repating for",
max(chrom.count[[i]][,2]),
"times."))
}
chroms <- read.csv("pruned.chroms.csv", as.is = T)
chroms <- read.csv("pruned.chroms.csv", as.is = T)
orders <- unique(chroms$order)
chrom.count <- vector(mode = "list", length = 11)
names(chrom.count) <- c("BlatAll", orders)
chroms <- read.csv("pruned.chroms.csv", as.is = T)
orders <- unique(chroms$order)
chroms <- read.csv("pruned.chroms.csv", as.is = T)
orders <- unique(chroms$order)
chrom.count <- vector(mode = "list", length = 11)
names(chrom.count) <- c("BlatAll", orders)
chroms <- read.csv("pruned.chroms.csv", as.is = T)
orders <- unique(chroms$order)
chrom.count <- vector(mode = "list", length = 11)
names(chrom.count) <- c("BlatAll", orders)
for(i in 1:11){
if(i == 1){
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order %in% c("Blattodea", "Isoptera")]),
stringsAsFactors = F)
}else{
chrom.count[[i]] <- data.frame(table(chroms$hap[chroms$order == orders[i-1]]),
stringsAsFactors = F)
}
}
for(i in 1:11){
print(paste("The mode of",
names(chrom.count)[i],
"is",
chrom.count[[i]][,1][chrom.count[[i]][,2] == max(chrom.count[[i]][,2])],
"repating for",
max(chrom.count[[i]][,2]),
"times."))
}
library(phytools)
trees <- read.nexus("../Trees/posterior.trees.nex")
chroms <- read.csv("pruned.chroms.csv", as.is = T)
trees <- read.nexus("../Trees/posterior.trees.nex")
sum(trees[[1]]$tip.label %in% chroms$species)
chroms <- read.csv("chroms.csv", as.is = T)
sum(trees[[1]]$tip.label %in% chroms$species)
sum(trees[[2]]$tip.label %in% chroms$species)
sum(chroms$species %in% trees[[2]]$tip.label)
sum(chroms$species %in% trees[[3]]$tip.label)
trees[[3]]$tip.label
dat <- chroms[chroms$species %in% trees[[1]]$tip.label]
dat <- chroms[chroms$species %in% trees[[1]]$tip.label,]
dat <- chroms[!(chroms$species %in% trees[[1]]$tip.label),]
dat.1 <- chroms[chroms$species %in% trees[[1]]$tip.label,]
dat.2 <- chroms[!(chroms$species %in% trees[[1]]$tip.label),]
trees <- read.nexus("../Trees/posterior.trees.nex")
orders <- unique(chroms$order)
chrom.count <- vector(mode = "list", length = 11)
dat.1 <- chroms[chroms$species %in% trees[[1]]$tip.label,]
dat.2 <- chroms[!(chroms$species %in% trees[[1]]$tip.label),]
trees <- read.nexus("../Trees/posterior.trees.nex")
library(phytools)
chroms <- read.csv("chroms.csv", as.is = T)
trees <- read.nexus("../Trees/posterior.trees.nex")
orders <- unique(chroms$order)
chrom.count <- vector(mode = "list", length = 11)
dat.1 <- chroms[chroms$species %in% trees[[1]]$tip.label,]
dat.2 <- chroms[!(chroms$species %in% trees[[1]]$tip.label),]
View(dat.1)
tree.sp.tips <- trees[[1]]$tip.label[!(trees[[1]]$tip.label %in% chroms$species)]
tree.sp.tips <- gsub(pattern = "_sp",
replacement = "",
x = tree.sp.tips)
dat.2$genus == tree.sp.tips[1]
table(dat.2$hap[dat.2$genus == tree.sp.tips[1]])
table(dat.2$hap[dat.2$genus == tree.sp.tips[2]])
table(dat.2$hap[dat.2$genus == tree.sp.tips[3]])
for(i in 1:57){
print(table(dat.2$hap[dat.2$genus == tree.sp.tips[i]]))
}
for(i in 1:57){
print(table(dat.2$hap[dat.2$genus == tree.sp.tips[i]]))
}
for(i in 1:57){
print(dat.2$order[dat.2$genus == tree.sp.tips[i]])
print(table(dat.2$hap[dat.2$genus == tree.sp.tips[i]]))
}
grep(pattern = "_sp", x = trees[[1]]$tip.label)
grep(pattern = "_sp", x = trees[[1]]$tip.label,value = T)
# Terrence Sylvester
# pradakshanas@gmail.com
# 11 February 2020
# finding the mode of chromosome number
#load libraries
library(phytools)
# read in chromosome data
chroms <- read.csv("chroms.csv",
as.is = T)
# remove rows which do not contain data
chroms <- chroms[!is.na(chroms$hap),]
# read in trees
trees <- read.nexus("../Trees/posterior.trees.nex")
# get the order names
orders <- unique(chroms$order)
# Make a list to store chromosome counts
chrom.count <- vector(mode = "list",
length = 11)
# name the list
names(chrom.count) <- c("Blatodia_sensu_lato", # includes Blarodea and Isoptera
orders)
# subset dataset so that first set will have exact species matches and
# second set will have genera level matches
# species level matches
dat.sp.level <- chroms[chroms$species %in% trees[[1]]$tip.label,]
# genera level matches
dat.gn.level <- chroms[!(chroms$species %in% trees[[1]]$tip.label),]
# get the genus names of the genera level matches
gn.names <- trees[[1]]$tip.label[!(trees[[1]]$tip.label %in% chroms$species)]
gn.names <- gsub(pattern = "_sp",
replacement = "",
x = gn.names)
!is.na(chroms$hap)
dat.gn.level$hap[dat.gn.level$genus == gn.names[1]]
# make a new data table
chroms.new <- matrix(data = NA,
nrow = length(trees[[1]]$tip.label),
ncol = 3)
colnames(chroms.new) <- c("Order",
"Sp.name",
"hap")
dat.gn.level = gn.names
# Terrence Sylvester
# pradakshanas@gmail.com
# 11 February 2020
# finding the mode of chromosome number
#load libraries
library(phytools)
# read in chromosome data
chroms <- read.csv("chroms.csv",
as.is = T)
# remove rows which do not contain data
chroms <- chroms[!is.na(chroms$hap),]
# read in trees
trees <- read.nexus("../Trees/posterior.trees.nex")
# get the order names
orders <- unique(chroms$order)
# Make a list to store chromosome counts
chrom.count <- vector(mode = "list",
length = 11)
# name the list
names(chrom.count) <- c("Blatodia_sensu_lato", # includes Blarodea and Isoptera
orders)
# subset dataset so that first set will have exact species matches and
# second set will have genera level matches
# species level matches
dat.sp.level <- chroms[chroms$species %in% trees[[1]]$tip.label,]
# genera level matches
dat.gn.level <- chroms[!(chroms$species %in% trees[[1]]$tip.label),]
# get the genus names of the genera level matches
gn.names <- trees[[1]]$tip.label[!(trees[[1]]$tip.label %in% chroms$species)]
gn.names <- gsub(pattern = "_sp",
replacement = "",
x = gn.names)
# make a new data table
chroms.new <- matrix(data = NA,
nrow = length(trees[[1]]$tip.label),
ncol = 3)
colnames(chroms.new) <- c("Order",
"Sp.name",
"hap")
dat.gn.level$genus == gn.names
dat.gn.level$genus %in% gn.names
dat.gn.level$order[dat.gn.level$genus %in% gn.names]
# fill species in the new data table
chroms.new[,2] <- c(dat.sp.level$species,
gn.names)
c(dat.sp.level$species,
gn.names)
View(dat.sp.level)
duplicated(dat.sp.level$species)
dat.sp.level[duplicated(dat.sp.level$species)]
dat.sp.level[duplicated(dat.sp.level$species),]
View(dat.sp.level)
duplicated(dat.sp.level$species, fromLast = t)
duplicated(dat.sp.level$species, fromLast = T)
duplicated(dat.sp.level$species, fromLast = T) | duplicated(dat.sp.level$species)
# duplicated records on species level matches
dat.sp.level.duplicated <- duplicated(dat.sp.level$species, fromLast = T) | duplicated(dat.sp.level$species)
# duplicated records on species level matches
dat.sp.level.duplicated <- dat.sp.level[duplicated(dat.sp.level$species, fromLast = T) | duplicated(dat.sp.level$species),]
# Unique records on species level matches
dat.sp.level.unique <- dat.sp.level[!(duplicated(dat.sp.level$species, fromLast = T) | duplicated(dat.sp.level$species)),]
232-57
sp.level.duplicated.names <- unique(dat.sp.level.duplicated$species)
colnames(chroms.new) <- c("Order",
"Sp.name",
1:100)
# make a new data table
chroms.new <- matrix(data = NA,
nrow = length(trees[[1]]$tip.label),
ncol = 103)
colnames(chroms.new) <- c("Order",
"Sp.name",
1:100)
colnames(chroms.new) <- c("Order",
"Sp.name",
1:100)
View(chroms.new)
colnames(chroms.new)
# make a new data table
chroms.new <- matrix(data = NA,
nrow = length(trees[[1]]$tip.label),
ncol = 102)
colnames(chroms.new) <- c("Order",
"Sp.name",
1:100)
# fill species in the new data table
chroms.new[,2] <- c(sp.level.duplicated.names,
dat.sp.level.unique$species
gn.names)
# fill species in the new data table
chroms.new[,2] <- c(sp.level.duplicated.names,
dat.sp.level.unique$species,
gn.names)
View(chroms.new)
View(dat.sp.level.duplicated)
View(dat.gn.level)
View(dat.sp.level.duplicated)
